use impl_vol_sys::*;

fn eq(expected: f64, actual: f64) {
  assert!(
    (expected - actual).abs() < f64::EPSILON,
    "expected: {}\n  actual: {},",
    expected,
    actual
  );
}

fn iv(
  price: f64,
  underlying: f64,
  strike: f64,
  r: f64,
  q: f64,
  t: f64,
  flag: char,
) -> f64 {
  iv_implied_volatility_from_a_transformed_rational_guess(
    price / (-r * t).exp(),
    underlying * ((r - q) * t).exp(),
    strike,
    t,
    binary_flag(flag),
  )
}

fn binary_flag(ch: char) -> f64 {
  match ch {
    'c' => 1.0,
    'p' => -1.0,
    _ => 1.0,
  }
}

#[test]
fn test_iv() {
  eq(
    0.3148253556850184,
    iv(511.55, 2104.32, 1700.00, 0.056700, 0.023300, 0.926027, 'c'),
  );
  eq(
    0.3005835339311901,
    iv(435.70, 2104.32, 1800.00, 0.056700, 0.023300, 0.926027, 'c'),
  );
  eq(
    0.28700565680447726,
    iv(364.35, 2104.32, 1900.00, 0.056700, 0.023300, 0.926027, 'c'),
  );
  eq(
    0.2743335201142195,
    iv(298.45, 2104.32, 2000.00, 0.056700, 0.023300, 0.926027, 'c'),
  );
  eq(
    0.25169991491284416,
    iv(230.50, 2104.32, 2100.00, 0.056700, 0.023300, 0.926027, 'c'),
  );
  eq(
    0.23327460982662723,
    iv(171.60, 2104.32, 2200.00, 0.056700, 0.023300, 0.926027, 'c'),
  );
  eq(
    0.2250561112015883,
    iv(127.90, 2104.32, 2300.00, 0.056700, 0.023300, 0.926027, 'c'),
  );
  eq(
    0.21984446432090532,
    iv(93.90, 2104.32, 2400.00, 0.056700, 0.023300, 0.926027, 'c'),
  );
  eq(
    0.21738114452619214,
    iv(68.60, 2104.32, 2500.00, 0.056700, 0.023300, 0.926027, 'c'),
  );
  eq(
    3.156649599921243,
    iv(655.70, 2104.32, 1450.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    3.02617150392871,
    iv(630.70, 2104.32, 1475.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    2.8975609692697217,
    iv(605.70, 2104.32, 1500.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    2.7707295863322567,
    iv(580.70, 2104.32, 1525.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    2.6455909325185045,
    iv(555.70, 2104.32, 1550.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    2.52206008175039,
    iv(530.70, 2104.32, 1575.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    2.400053080604957,
    iv(505.70, 2104.32, 1600.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    2.2794863752310346,
    iv(480.70, 2104.32, 1625.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    2.1602761686971643,
    iv(455.70, 2104.32, 1650.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    2.042337681975436,
    iv(430.70, 2104.32, 1675.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.6304380276058712,
    iv(404.85, 2104.32, 1700.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.80992643000417,
    iv(380.70, 2104.32, 1725.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.2146964770768587,
    iv(354.60, 2104.32, 1750.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.5815164754122906,
    iv(330.70, 2104.32, 1775.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.0342741992659326,
    iv(304.60, 2104.32, 1800.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.3562735519417453,
    iv(280.70, 2104.32, 1825.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.244532348725751,
    iv(255.70, 2104.32, 1850.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.1331792595442773,
    iv(230.70, 2104.32, 1875.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.8204988703734793,
    iv(204.80, 2104.32, 1900.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.7261575194492099,
    iv(179.80, 2104.32, 1925.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.6320297064892296,
    iv(154.80, 2104.32, 1950.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.5958680865558811,
    iv(130.05, 2104.32, 1975.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.5294440140729184,
    iv(105.30, 2104.32, 2000.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.496388440997469,
    iv(81.20, 2104.32, 2025.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.43568760638112863,
    iv(57.50, 2104.32, 2050.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.3833302559436945,
    iv(35.51, 2104.32, 2075.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.321294483187517,
    iv(16.51, 2104.32, 2100.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.30448152962469793,
    iv(5.63, 2104.32, 2125.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.3214700368943528,
    iv(1.74, 2104.32, 2150.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.4302029210097354,
    iv(1.54, 2104.32, 2175.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.445169852050396,
    iv(0.55, 2104.32, 2200.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.493259600805132,
    iv(0.31, 2104.32, 2225.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.5605833299002175,
    iv(0.25, 2104.32, 2250.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.6553373226155671,
    iv(0.30, 2104.32, 2275.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.6644757991705206,
    iv(0.13, 2104.32, 2300.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.7628183869400739,
    iv(0.18, 2104.32, 2325.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.8291564777805057,
    iv(0.17, 2104.32, 2350.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.9047019742509538,
    iv(0.18, 2104.32, 2375.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.9735706275145919,
    iv(0.18, 2104.32, 2400.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.0411802623686313,
    iv(0.18, 2104.32, 2425.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.1009177441264046,
    iv(0.17, 2104.32, 2450.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.1659088594872704,
    iv(0.17, 2104.32, 2475.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.3601070453836441,
    iv(0.42, 2104.32, 2500.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.6657676343912893,
    iv(1.34, 2104.32, 2525.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.741060747812004,
    iv(1.34, 2104.32, 2550.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.8131434885275455,
    iv(1.33, 2104.32, 2575.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.88594812556506,
    iv(1.33, 2104.32, 2600.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    1.9576179947589516,
    iv(1.33, 2104.32, 2625.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    2.0281995863237654,
    iv(1.33, 2104.32, 2650.00, 0.044700, 0.000000, 0.002740, 'c'),
  );
  eq(
    0.5178883470574448,
    iv(662.30, 2104.32, 1450.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.48507298658100845,
    iv(612.70, 2104.32, 1500.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.4443923741330698,
    iv(562.95, 2104.32, 1550.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.4228318355491343,
    iv(513.65, 2104.32, 1600.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.4021809805104577,
    iv(464.55, 2104.32, 1650.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.38353835632012456,
    iv(415.80, 2104.32, 1700.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.3676721503024618,
    iv(367.65, 2104.32, 1750.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.35893227834267866,
    iv(320.85, 2104.32, 1800.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.3438379137800945,
    iv(274.70, 2104.32, 1850.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.328172838629933,
    iv(229.95, 2104.32, 1900.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.3139830536774275,
    iv(187.45, 2104.32, 1950.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.30162767507578825,
    iv(148.10, 2104.32, 2000.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.28547950595440386,
    iv(111.45, 2104.32, 2050.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.2544430486906813,
    iv(75.15, 2104.32, 2100.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.22830157966228282,
    iv(45.41, 2104.32, 2150.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.22237047363881032,
    iv(27.30, 2104.32, 2200.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.21738106367592602,
    iv(15.13, 2104.32, 2250.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.21399792731678968,
    iv(7.80, 2104.32, 2300.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.21074388620694393,
    iv(3.67, 2104.32, 2350.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.20746196828632452,
    iv(1.56, 2104.32, 2400.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.2296484395247883,
    iv(1.35, 2104.32, 2450.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.2553625408850053,
    iv(1.34, 2104.32, 2500.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.27183955865275944,
    iv(1.08, 2104.32, 2550.00, 0.047000, 0.000000, 0.101370, 'c'),
  );
  eq(
    0.44268574506046493,
    iv(620.60, 2104.32, 1500.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.4240944652699312,
    iv(572.10, 2104.32, 1550.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.40608429760795844,
    iv(523.90, 2104.32, 1600.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.3907829451933676,
    iv(476.30, 2104.32, 1650.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.3788994507921304,
    iv(429.65, 2104.32, 1700.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.36591015628252743,
    iv(383.70, 2104.32, 1750.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.35085090681066916,
    iv(338.40, 2104.32, 1800.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.33270429498506854,
    iv(293.60, 2104.32, 1850.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.3169882479054649,
    iv(250.60, 2104.32, 1900.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.30353367806184156,
    iv(209.95, 2104.32, 1950.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.2911407289926108,
    iv(171.95, 2104.32, 2000.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.27804494276044445,
    iv(136.60, 2104.32, 2050.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.25431008489820833,
    iv(100.90, 2104.32, 2100.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.23496845214754494,
    iv(70.60, 2104.32, 2150.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.229051038425291,
    iv(49.62, 2104.32, 2200.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.22402394929677796,
    iv(33.45, 2104.32, 2250.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.21937676896877012,
    iv(21.50, 2104.32, 2300.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.21506050472633984,
    iv(13.13, 2104.32, 2350.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.21353610949467353,
    iv(7.96, 2104.32, 2400.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.20959542692570957,
    iv(4.38, 2104.32, 2450.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.21005987348164243,
    iv(2.55, 2104.32, 2500.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.2097145055300775,
    iv(1.41, 2104.32, 2550.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.21850692370199207,
    iv(1.04, 2104.32, 2600.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.21696781825850886,
    iv(0.54, 2104.32, 2650.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.26088509964846995,
    iv(1.32, 2104.32, 2700.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.24805477644336507,
    iv(0.54, 2104.32, 2750.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.25290733225991063,
    iv(0.38, 2104.32, 2800.00, 0.050300, 0.003100, 0.178082, 'c'),
  );
  eq(
    0.41124517537850763,
    iv(639.50, 2104.32, 1500.00, 0.055200, 0.023000, 0.427397, 'c'),
  );
  eq(
    0.3860926174899782,
    iv(549.75, 2104.32, 1600.00, 0.055200, 0.023000, 0.427397, 'c'),
  );
  eq(
    0.36141987629703914,
    iv(462.60, 2104.32, 1700.00, 0.055200, 0.023000, 0.427397, 'c'),
  );
  eq(
    0.3392923061131221,
    iv(379.65, 2104.32, 1800.00, 0.055200, 0.023000, 0.427397, 'c'),
  );
  eq(
    0.3197836689359561,
    iv(302.45, 2104.32, 1900.00, 0.055200, 0.023000, 0.427397, 'c'),
  );
  eq(
    0.3035914171588155,
    iv(233.10, 2104.32, 2000.00, 0.055200, 0.023000, 0.427397, 'c'),
  );
  eq(
    0.25695887601470463,
    iv(155.35, 2104.32, 2100.00, 0.055200, 0.023000, 0.427397, 'c'),
  );
  eq(
    0.21965579073664832,
    iv(91.40, 2104.32, 2200.00, 0.055200, 0.023000, 0.427397, 'c'),
  );
  eq(
    0.215643014415276,
    iv(57.20, 2104.32, 2300.00, 0.055200, 0.023000, 0.427397, 'c'),
  );
  eq(
    0.212456555145817,
    iv(33.86, 2104.32, 2400.00, 0.055200, 0.023000, 0.427397, 'c'),
  );
  eq(
    0.20950754282579842,
    iv(18.87, 2104.32, 2500.00, 0.055200, 0.023000, 0.427397, 'c'),
  );
  eq(
    0.20757247923192873,
    iv(10.06, 2104.32, 2600.00, 0.055200, 0.023000, 0.427397, 'c'),
  );
  eq(
    0.20191156086956102,
    iv(4.59, 2104.32, 2700.00, 0.055200, 0.023000, 0.427397, 'c'),
  );
  eq(
    0.19966394865701478,
    iv(2.11, 2104.32, 2800.00, 0.055200, 0.023000, 0.427397, 'c'),
  );
  eq(
    0.3747403424374556,
    iv(658.90, 2104.32, 1500.00, 0.056200, 0.023300, 0.676712, 'c'),
  );
  eq(
    0.35413761458177745,
    iv(572.80, 2104.32, 1600.00, 0.056200, 0.023300, 0.676712, 'c'),
  );
  eq(
    0.33519089141991903,
    iv(489.90, 2104.32, 1700.00, 0.056200, 0.023300, 0.676712, 'c'),
  );
  eq(
    0.31771442812234557,
    iv(411.05, 2104.32, 1800.00, 0.056200, 0.023300, 0.676712, 'c'),
  );
  eq(
    0.301615737097542,
    iv(337.25, 2104.32, 1900.00, 0.056200, 0.023300, 0.676712, 'c'),
  );
  eq(
    0.28741909753733086,
    iv(269.95, 2104.32, 2000.00, 0.056200, 0.023300, 0.676712, 'c'),
  );
  eq(
    0.2507377324276666,
    iv(194.15, 2104.32, 2100.00, 0.056200, 0.023300, 0.676712, 'c'),
  );
  eq(
    0.2277147044229386,
    iv(134.15, 2104.32, 2200.00, 0.056200, 0.023300, 0.676712, 'c'),
  );
  eq(
    0.22200097660645288,
    iv(94.75, 2104.32, 2300.00, 0.056200, 0.023300, 0.676712, 'c'),
  );
  eq(
    0.21737840351055399,
    iv(64.70, 2104.32, 2400.00, 0.056200, 0.023300, 0.676712, 'c'),
  );
  eq(
    0.21368581226954708,
    iv(42.79, 2104.32, 2500.00, 0.056200, 0.023300, 0.676712, 'c'),
  );
  eq(
    0.21047824290728326,
    iv(27.36, 2104.32, 2600.00, 0.056200, 0.023300, 0.676712, 'c'),
  );
  eq(
    0.20830918074494287,
    iv(17.13, 2104.32, 2700.00, 0.056200, 0.023300, 0.676712, 'c'),
  );
  eq(
    0.20498048988423265,
    iv(10.10, 2104.32, 2800.00, 0.056200, 0.023300, 0.676712, 'c'),
  );
  eq(
    0.3149444210823517,
    iv(65.25, 2104.32, 1700.00, 0.056700, 0.023300, 0.926027, 'p'),
  );
  eq(
    0.300712632262775,
    iv(84.30, 2104.32, 1800.00, 0.056700, 0.023300, 0.926027, 'p'),
  );
  eq(
    0.2870665551751435,
    iv(107.80, 2104.32, 1900.00, 0.056700, 0.023300, 0.926027, 'p'),
  );
  eq(
    0.2744099970977063,
    iv(136.80, 2104.32, 2000.00, 0.056700, 0.023300, 0.926027, 'p'),
  );
  eq(
    0.2517260040130328,
    iv(163.70, 2104.32, 2100.00, 0.056700, 0.023300, 0.926027, 'p'),
  );
  eq(
    0.23331902338456798,
    iv(199.70, 2104.32, 2200.00, 0.056700, 0.023300, 0.926027, 'p'),
  );
  eq(
    0.22512039031279982,
    iv(250.90, 2104.32, 2300.00, 0.056700, 0.023300, 0.926027, 'p'),
  );
  eq(
    0.21986516962949168,
    iv(311.75, 2104.32, 2400.00, 0.056700, 0.023300, 0.926027, 'p'),
  );
  eq(
    0.21742640958863418,
    iv(381.35, 2104.32, 2500.00, 0.056700, 0.023300, 0.926027, 'p'),
  );
  eq(
    3.159293472938379,
    iv(1.21, 2104.32, 1450.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    3.02975981903499,
    iv(1.21, 2104.32, 1475.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    2.8987711314122224,
    iv(1.20, 2104.32, 1500.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    2.775999245515769,
    iv(1.21, 2104.32, 1525.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    2.6485773507179187,
    iv(1.20, 2104.32, 1550.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    2.5258316962488405,
    iv(1.20, 2104.32, 1575.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    2.4045419796248124,
    iv(1.20, 2104.32, 1600.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    2.284625006507188,
    iv(1.20, 2104.32, 1625.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    2.163414364647595,
    iv(1.19, 2104.32, 1650.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    2.0461033927027947,
    iv(1.19, 2104.32, 1675.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.6351422583993305,
    iv(0.33, 2104.32, 1700.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.812485001060158,
    iv(1.18, 2104.32, 1725.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.185509520968369,
    iv(0.05, 2104.32, 1750.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.5830336252213377,
    iv(1.17, 2104.32, 1775.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.063255464377132,
    iv(0.08, 2104.32, 1800.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.356916747599217,
    iv(1.16, 2104.32, 1825.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.2439414504959638,
    iv(1.15, 2104.32, 1850.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.1331201772765422,
    iv(1.15, 2104.32, 1875.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.8255854579242277,
    iv(0.26, 2104.32, 1900.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.7319131172110781,
    iv(0.26, 2104.32, 1925.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.6382183551596223,
    iv(0.26, 2104.32, 1950.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.5924350524469787,
    iv(0.47, 2104.32, 1975.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.5300686055788173,
    iv(0.74, 2104.32, 2000.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.4955504144755588,
    iv(1.62, 2104.32, 2025.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.4366294905997267,
    iv(2.95, 2104.32, 2050.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.38345152965308266,
    iv(5.94, 2104.32, 2075.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.32122988214060244,
    iv(11.93, 2104.32, 2100.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.30448832714635776,
    iv(26.05, 2104.32, 2125.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.3216367578231006,
    iv(47.16, 2104.32, 2150.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.4299665284937345,
    iv(71.95, 2104.32, 2175.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.44372362255200226,
    iv(95.95, 2104.32, 2200.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.48923330247156727,
    iv(120.70, 2104.32, 2225.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.5592691967899464,
    iv(145.65, 2104.32, 2250.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.6549396586645222,
    iv(170.70, 2104.32, 2275.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.67608137752176,
    iv(195.55, 2104.32, 2300.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.7743014377986397,
    iv(220.60, 2104.32, 2325.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.8223421389268332,
    iv(245.55, 2104.32, 2350.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.8936083399226362,
    iv(270.55, 2104.32, 2375.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.9637531994295445,
    iv(295.55, 2104.32, 2400.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.0328481776242806,
    iv(320.55, 2104.32, 2425.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.10095375422797,
    iv(345.55, 2104.32, 2450.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.1681219494235855,
    iv(370.55, 2104.32, 2475.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.362497504412788,
    iv(395.80, 2104.32, 2500.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.6637798871354958,
    iv(421.70, 2104.32, 2525.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.739592675792554,
    iv(446.70, 2104.32, 2550.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.814199273573531,
    iv(471.70, 2104.32, 2575.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.887654353386955,
    iv(496.70, 2104.32, 2600.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    1.9600075029418214,
    iv(521.70, 2104.32, 2625.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    2.031303962825265,
    iv(546.70, 2104.32, 2650.00, 0.044700, 0.000000, 0.002740, 'p'),
  );
  eq(
    0.519850331232684,
    iv(1.12, 2104.32, 1450.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.48557689130952575,
    iv(1.26, 2104.32, 1500.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.4442579484011604,
    iv(1.26, 2104.32, 1550.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.4233780036440663,
    iv(1.74, 2104.32, 1600.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.4016967665873546,
    iv(2.37, 2104.32, 1650.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.3841591464566587,
    iv(3.43, 2104.32, 1700.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.3679431655250154,
    iv(5.03, 2104.32, 1750.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.3592114111278033,
    iv(8.00, 2104.32, 1800.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.3440331056201355,
    iv(11.61, 2104.32, 1850.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.3283116202289175,
    iv(16.62, 2104.32, 1900.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.3140288661528149,
    iv(23.87, 2104.32, 1950.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.30174660726420605,
    iv(34.30, 2104.32, 2000.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.2854140955612732,
    iv(47.37, 2104.32, 2050.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.2546369366703804,
    iv(60.90, 2104.32, 2100.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.2284124149498455,
    iv(80.90, 2104.32, 2150.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.22248525960318433,
    iv(112.55, 2104.32, 2200.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.21729619826323698,
    iv(150.10, 2104.32, 2250.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.2140135803491801,
    iv(192.55, 2104.32, 2300.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.21098506392413965,
    iv(238.20, 2104.32, 2350.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.20784428698373994,
    iv(285.85, 2104.32, 2400.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.23004413491363995,
    iv(335.40, 2104.32, 2450.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.25572532663771547,
    iv(385.15, 2104.32, 2500.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.2722038980702678,
    iv(434.65, 2104.32, 2550.00, 0.047000, 0.000000, 0.101370, 'p'),
  );
  eq(
    0.44277864026461183,
    iv(4.07, 2104.32, 1500.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.423951716475935,
    iv(5.11, 2104.32, 1550.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.40591493696532394,
    iv(6.46, 2104.32, 1600.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.3910147948483073,
    iv(8.45, 2104.32, 1650.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.3790519218852293,
    iv(11.35, 2104.32, 1700.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.3658033084794829,
    iv(14.92, 2104.32, 1750.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.35079480824274817,
    iv(19.18, 2104.32, 1800.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.332831586817996,
    iv(23.97, 2104.32, 1850.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.31708050087263157,
    iv(30.52, 2104.32, 1900.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.30348887477724296,
    iv(39.39, 2104.32, 1950.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.2911200130647552,
    iv(50.95, 2104.32, 2000.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.2780135269197088,
    iv(65.15, 2104.32, 2050.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.254268449469205,
    iv(79.00, 2104.32, 2100.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.23505715618594225,
    iv(98.30, 2104.32, 2150.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.2290724085266151,
    iv(126.85, 2104.32, 2200.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.22410062312404985,
    iv(160.25, 2104.32, 2250.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.2194517986077905,
    iv(197.85, 2104.32, 2300.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.2149837094034084,
    iv(239.00, 2104.32, 2350.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.21354072419231343,
    iv(283.40, 2104.32, 2400.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.2093643138301339,
    iv(329.35, 2104.32, 2450.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.2100949097173503,
    iv(377.10, 2104.32, 2500.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.20945394057556008,
    iv(425.50, 2104.32, 2550.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.2186277951286067,
    iv(474.70, 2104.32, 2600.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.2169709151643707,
    iv(523.75, 2104.32, 2650.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.26132095837717184,
    iv(574.10, 2104.32, 2700.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.24761633018311635,
    iv(622.85, 2104.32, 2750.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.2527412298159814,
    iv(672.25, 2104.32, 2800.00, 0.050300, 0.003100, 0.178082, 'p'),
  );
  eq(
    0.41134905571706226,
    iv(20.81, 2104.32, 1500.00, 0.055200, 0.023000, 0.427397, 'p'),
  );
  eq(
    0.38634479730938937,
    iv(28.77, 2104.32, 1600.00, 0.055200, 0.023000, 0.427397, 'p'),
  );
  eq(
    0.36152899735394906,
    iv(39.26, 2104.32, 1700.00, 0.055200, 0.023000, 0.427397, 'p'),
  );
  eq(
    0.3394402792844221,
    iv(54.00, 2104.32, 1800.00, 0.055200, 0.023000, 0.427397, 'p'),
  );
  eq(
    0.31986679589203587,
    iv(74.45, 2104.32, 1900.00, 0.055200, 0.023000, 0.427397, 'p'),
  );
  eq(
    0.3037283122396698,
    iv(102.80, 2104.32, 2000.00, 0.055200, 0.023000, 0.427397, 'p'),
  );
  eq(
    0.25705160323153403,
    iv(122.70, 2104.32, 2100.00, 0.055200, 0.023000, 0.427397, 'p'),
  );
  eq(
    0.21971381810933072,
    iv(156.40, 2104.32, 2200.00, 0.055200, 0.023000, 0.427397, 'p'),
  );
  eq(
    0.21577168878039,
    iv(219.90, 2104.32, 2300.00, 0.055200, 0.023000, 0.427397, 'p'),
  );
  eq(
    0.21254235984957484,
    iv(294.20, 2104.32, 2400.00, 0.055200, 0.023000, 0.427397, 'p'),
  );
  eq(
    0.20969412685858838,
    iv(376.90, 2104.32, 2500.00, 0.055200, 0.023000, 0.427397, 'p'),
  );
  eq(
    0.2078026317658724,
    iv(465.75, 2104.32, 2600.00, 0.055200, 0.023000, 0.427397, 'p'),
  );
  eq(
    0.20230730910699307,
    iv(557.95, 2104.32, 2700.00, 0.055200, 0.023000, 0.427397, 'p'),
  );
  eq(
    0.20051418828523834,
    iv(653.15, 2104.32, 2800.00, 0.055200, 0.023000, 0.427397, 'p'),
  );
  eq(
    0.3747977655967484,
    iv(31.54, 2104.32, 1500.00, 0.056200, 0.023300, 0.676712, 'p'),
  );
  eq(
    0.3542762338776348,
    iv(41.74, 2104.32, 1600.00, 0.056200, 0.023300, 0.676712, 'p'),
  );
  eq(
    0.33528634806426316,
    iv(55.10, 2104.32, 1700.00, 0.056200, 0.023300, 0.676712, 'p'),
  );
  eq(
    0.31775819725955773,
    iv(72.50, 2104.32, 1800.00, 0.056200, 0.023300, 0.676712, 'p'),
  );
  eq(
    0.3017106893952593,
    iv(95.00, 2104.32, 1900.00, 0.056200, 0.023300, 0.676712, 'p'),
  );
  eq(
    0.2874751756073711,
    iv(123.95, 2104.32, 2000.00, 0.056200, 0.023300, 0.676712, 'p'),
  );
  eq(
    0.25076261174705244,
    iv(144.40, 2104.32, 2100.00, 0.056200, 0.023300, 0.676712, 'p'),
  );
  eq(
    0.22778565317498453,
    iv(180.70, 2104.32, 2200.00, 0.056200, 0.023300, 0.676712, 'p'),
  );
  eq(
    0.22204667869563832,
    iv(237.55, 2104.32, 2300.00, 0.056200, 0.023300, 0.676712, 'p'),
  );
  eq(
    0.21739801399067926,
    iv(303.75, 2104.32, 2400.00, 0.056200, 0.023300, 0.676712, 'p'),
  );
  eq(
    0.21379099783528382,
    iv(378.15, 2104.32, 2500.00, 0.056200, 0.023300, 0.676712, 'p'),
  );
  eq(
    0.21051500066557846,
    iv(458.95, 2104.32, 2600.00, 0.056200, 0.023300, 0.676712, 'p'),
  );
  eq(
    0.20839399335900793,
    iv(545.00, 2104.32, 2700.00, 0.056200, 0.023300, 0.676712, 'p'),
  );
  eq(
    0.20514895061342647,
    iv(634.25, 2104.32, 2800.00, 0.056200, 0.023300, 0.676712, 'p'),
  );
}
